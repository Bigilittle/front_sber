const numberMap = {
  ноль: 0, нулевая: 0, нулевое: 0, нулевой: 0,

  один: 1, одна: 1, одно: 1, первого: 1, первую: 1, первой: 1, первое: 1, первый: 1, первая: 1,
  два: 2, две: 2, второй: 2, вторая: 2, второе: 2, второго: 2, вторую: 2, второй: 2,
  три: 3, третья: 3, третье: 3, третий: 3, третьего: 3, третью: 3,
  четыре: 4, четвёртая: 4, четвёртое: 4, четвёртый: 4, четвертая: 4, четвертое: 4, четвертый: 4, четвёртую: 4,
  пять: 5, пятая: 5, пятое: 5, пятый: 5, пятую: 5,
  шесть: 6, шестая: 6, шестое: 6, шестой: 6, шестую: 6,
  семь: 7, седьмая: 7, седьмое: 7, седьмой: 7, седьмую: 7,
  восемь: 8, восьмая: 8, восьмое: 8, восьмой: 8, восьмую: 8,
  девять: 9, девятая: 9, девятое: 9, девятый: 9, девятую: 9,
  десять: 10, десятая: 10, десятое: 10, десятый: 10, десятую: 10,

  одиннадцать: 11, одиннадцатая: 11, одиннадцатое: 11, одиннадцатый: 11,
  двенадцать: 12, двенадцатая: 12, двенадцатое: 12, двенадцатый: 12,
  тринадцать: 13, тринадцатая: 13, тринадцатое: 13, тринадцатый: 13,
  четырнадцать: 14, четырнадцатая: 14, четырнадцатое: 14, четырнадцатый: 14,
  пятнадцать: 15, пятнадцатая: 15, пятнадцатое: 15, пятнадцатый: 15,
  шестнадцать: 16, шестнадцатая: 16, шестнадцатое: 16, шестнадцатый: 16,
  семнадцать: 17, семнадцатая: 17, семнадцатое: 17, семнадцатый: 17,
  восемнадцать: 18, восемнадцатая: 18, восемнадцатое: 18, восемнадцатый: 18,
  девятнадцать: 19, девятнадцатая: 19, девятнадцатое: 19, девятнадцатый: 19,
  двадцать: 20, двадцатая: 20, двадцатое: 20, двадцатый: 20,

  двадцать_один: 21, двадцать_первая: 21, двадцать_первое: 21, двадцать_первый: 21,
  двадцать_два: 22, двадцать_вторая: 22, двадцать_второе: 22, двадцать_второй: 22,
  двадцать_три: 23, двадцать_третья: 23, двадцать_третье: 23, двадцать_третий: 23,
  двадцать_четыре: 24, двадцать_четвёртая: 24, двадцать_четвёртое: 24, двадцать_четвёртый: 24,
  двадцать_пять: 25, двадцать_пятая: 25, двадцать_пятое: 25, двадцать_пятый: 25,
};

const special = {
  'd': 'd', 'д': 'd', 'к': 'd', 'the': 'd',
  'плюс': '+',
  'минус': '-',
};

function normalizeDice(input) {
  if (typeof input !== 'string') input = String(input);

  return input
    .toLowerCase()
    .split(/\s+/)
    .map(tok => {
      if (special[tok]) return special[tok];
      if (numberMap[tok]) return numberMap[tok];
      if (tok.includes('двадцать')) {
        const parts = tok.split(/[-_ ]+/); // на случай "двадцать-пятая"
        const combined = parts.join('_');
        if (numberMap[combined]) return numberMap[combined];
      }
      return tok; // например, "1d6"
    })
    .join('');
}

export { normalizeDice };
